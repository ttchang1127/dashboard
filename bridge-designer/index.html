<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PCI 梁橋互動設計工具 (台灣規範)</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Noto+Sans+TC:wght@400;500;700&display=swap" rel="stylesheet">
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css" integrity="sha384-n8MVd4RsNIU0tAv4ct0nTaAbDJwPJzDEaqSD1odI+WdtXRGWt2kTvGFasHpSy3SV" crossorigin="anonymous">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js" integrity="sha384-XjKyOOlGwcjNTAIQHIpgOno0Hl1YQqzUOEleOLALmuqehneUG+vnGctmUb0ZY0l8" crossorigin="anonymous"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js" integrity="sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05" crossorigin="anonymous"></script>
    
    <link rel="stylesheet" href="css/style.css">
</head>
<body class="bg-slate-100 flex items-center justify-center min-h-screen p-4">

    <div class="w-full max-w-screen-xl flex flex-col h-[90vh]">
        <div class="w-full flex border-b border-slate-300">
            <button id="main-tab-section" class="main-tab-button active">橋梁斷面尺寸</button>
            <button id="main-tab-table" class="main-tab-button">橋梁尺寸表</button>
            <button id="main-tab-tendon" class="main-tab-button">預力鋼腱配置</button>
            <button id="main-tab-loss-calc" class="main-tab-button">計算預力損失</button>
            <button id="main-tab-stress-check" class="main-tab-button">應力檢核</button>
            <button id="main-tab-flexure-check" class="main-tab-button">撓曲強度檢核</button>
            <button id="main-tab-deflection-check" class="main-tab-button">撓度檢核</button>
            <button id="main-tab-shear-check" class="main-tab-button">剪力筋檢核</button>
        </div>

        <div id="main-content-wrapper" class="w-full flex-grow bg-white rounded-b-lg rounded-tr-lg shadow-lg overflow-hidden">
            
            <div id="section-view" class="flex flex-col md:flex-row w-full h-full">
                <div id="input-panel" class="w-full md:w-4/12 p-6 md:p-8 bg-slate-50 border-r border-slate-200 overflow-y-auto">
                    <h1 class="text-2xl font-bold text-slate-800 mb-2">斷面尺寸參數</h1>
                    <p class="text-slate-500 mb-6">請選擇跨度以載入建議尺寸，或手動輸入。</p>
                    <div class="mb-6">
                        <label for="bridge-span" class="block text-sm font-medium text-slate-700 mb-1">橋梁跨度 (m)</label>
                        <select id="bridge-span" class="w-full p-2 border border-slate-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500">
                            <option value="25">25</option>
                            <option value="30">30</option>
                            <option value="35" selected>35</option>
                            <option value="40">40</option>
                            <option value="45">45</option>
                        </select>
                    </div>
                    <table class="w-full text-sm">
                        <tbody class="divide-y divide-slate-200">
                            <script>
                                const createInputRow = (id, label, value, step, unit) => {
                                    document.write(`<tr class="divide-x divide-slate-200"><td class="py-3 pr-4 w-1/2 font-medium text-slate-700">${label} (${unit})</td><td class="py-2 pl-4 w-1/2"><div class="relative flex items-center"><input type="number" id="${id}" value="${value}" step="${step}" class="w-full p-2 border border-slate-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 text-right pr-8"><div class="absolute right-0 flex flex-col"><button data-input="${id}" data-action="increment" class="number-button h-5 w-6 text-xs leading-none flex items-center justify-center border-l border-b border-slate-300 rounded-tr-md hover:bg-slate-200">+</button><button data-input="${id}" data-action="decrement" class="number-button h-5 w-6 text-xs leading-none flex items-center justify-center border-l border-t border-slate-300 rounded-br-md hover:bg-slate-200">-</button></div></div></td></tr>`);
                                };
                                createInputRow('ght', '大梁總高 (GHT)', 2000, 1, 'mm'); createInputRow('gwb', '腹板寬度 (GWB)', 200, 1, 'mm'); createInputRow('tft', '頂版厚度 (TFT)', 150, 1, 'mm'); createInputRow('h1', '頂版懸臂厚度 (H1)', 150, 1, 'mm'); createInputRow('gtf', '頂版寬度 (GTF)', 1100, 1, 'mm'); createInputRow('bft', '底版厚度 (BFT)', 240, 1, 'mm'); createInputRow('h3', '底版懸臂厚度 (H3)', 210, 1, 'mm'); createInputRow('f2', '底版懸臂寬度 (F2)', 235, 1, 'mm');
                            </script>
                        </tbody>
                    </table>
                </div>
                <div id="right-panel-container" class="w-full md:w-8/12 flex flex-col p-6 md:p-8"><div class="w-full flex border-b border-slate-200 mb-4"><button id="sub-tab-mid" class="sub-tab-button active px-4 py-2 text-sm font-semibold text-slate-600 border-b-2 border-transparent -mb-px">PCI梁中央斷面</button><button id="sub-tab-end" class="sub-tab-button px-4 py-2 text-sm font-semibold text-slate-600 border-b-2 border-transparent -mb-px">PCI梁端部斷面</button></div><div class="w-full flex-grow relative"><div id="mid-canvas-wrapper" class="sub-tab-content w-full h-full"><canvas id="midSpanCanvas"></canvas></div><div id="end-canvas-wrapper" class="sub-tab-content w-full h-full hidden"><canvas id="endSpanCanvas"></canvas></div></div></div>
            </div>
            <div id="size-table-view" class="hidden w-full h-full p-6 md:p-8 overflow-y-auto"><h2 class="text-xl font-semibold text-slate-800 mb-4">PCI橋梁尺寸參考表</h2><img src="https://ttchang1127.github.io/dashboard/images/PCI%E6%A9%8B%E6%A2%81%E6%96%B7%E9%9D%A2%E5%B0%BA%E5%AF%B8.png" alt="PCI橋梁斷面尺寸參考表" class="w-full max-w-4xl mx-auto block rounded-lg shadow-md"></div>
            <div id="tendon-view" class="hidden w-full h-full flex flex-col md:flex-row">
                 <div id="tendon-input-panel" class="w-full md:w-[30%] p-6 md:p-8 bg-slate-50 border-r border-slate-200 overflow-y-auto"><h1 class="text-2xl font-bold text-slate-800 mb-6">鋼腱配置參數</h1><div class="space-y-4"><div><label for="tendon-type" class="block text-sm font-medium text-slate-700 mb-1">鋼腱型號</label><select id="tendon-type" class="w-full p-2 border border-slate-300 rounded-md shadow-sm"><option value="12S12.7A">12S12.7 (SWPR7A)</option><option value="12S12.7B">12S12.7 (SWPR7B)</option><option value="12S15.2" selected>12S15.2 (SWPR7B)</option></select></div><div><label for="tendon-mid-count" class="block text-sm font-medium text-slate-700 mb-1">中央斷面鋼腱數量</label><select id="tendon-mid-count" class="w-full p-2 border border-slate-300 rounded-md shadow-sm"><option value="3">3</option><option value="4">4</option><option value="5" selected>5</option><option value="6">6</option><option value="7">7</option></select><input type="hidden" id="tendon-end-count" value="5"></div><div><label for="tendon-area-display" class="block text-sm font-medium text-slate-700 mb-1">每束鋼腱面積 (mm²)</label><p id="tendon-area-display" class="p-2 bg-slate-200 rounded-md text-sm">1664.4</p></div><div id="tendon-coord-container" class="hidden"><h3 class="text-base font-semibold text-slate-800 mt-6 mb-2">鋼腱座標 (mm)</h3><table class="w-full text-sm"><thead class="text-left text-slate-500 bg-slate-100"><tr><th class="p-2">ID</th><th class="p-2 text-right">X</th><th class="p-2 text-right">Y</th></tr></thead><tbody id="tendon-coord-table-body"></tbody></table></div></div></div>
                 <div id="tendon-display-panel" class="w-full md:w-[70%] p-6 md:p-8 flex flex-col"><div class="w-full flex border-b border-slate-200 mb-4"><button id="tendon-tab-mid" class="sub-tab-button active px-4 py-2 text-sm font-semibold text-slate-600 border-b-2 border-transparent -mb-px">PCI梁中央斷面</button><button id="tendon-tab-end" class="sub-tab-button px-4 py-2 text-sm font-semibold text-slate-600 border-b-2 border-transparent -mb-px">PCI梁端部斷面</button><button id="tendon-tab-side" class="sub-tab-button px-4 py-2 text-sm font-semibold text-slate-600 border-b-2 border-transparent -mb-px">PCI梁側面</button></div><div class="w-full flex-grow relative bg-slate-100/50 rounded-md"><div id="tendon-content-mid" class="w-full h-full flex items-center justify-center"><canvas id="tendonMidSpanCanvas"></canvas></div><div id="tendon-content-end" class="w-full h-full hidden items-center justify-center"><canvas id="tendonEndSpanCanvas"></canvas></div><div id="tendon-content-side" class="w-full h-full hidden items-center justify-center"><canvas id="tendonSideViewCanvas"></canvas></div></div></div>
            </div>
            <div id="loss-calc-view" class="hidden w-full h-full flex flex-col md:flex-row">
                <div class="w-full md:w-4/12 p-6 md:p-8 bg-slate-50 border-r border-slate-200 overflow-y-auto"><h1 class="text-2xl font-bold text-slate-800 mb-6">預力損失計算參數</h1>
                    <h2 class="text-lg font-semibold text-slate-700 border-b pb-2 mb-3">瞬時損失參數</h2>
                    <div class="space-y-3">
                        <div><label for="tendon-initial-force" class="block text-sm font-medium text-slate-700 mb-1">每束鋼腱施拉力 (kN)</label><input type="number" id="tendon-initial-force" value="2164" step="10" class="w-full p-2 border border-slate-300 rounded-md"><details class="text-xs text-slate-500 mt-1"><summary class="cursor-pointer">建議值: <span id="recommended-force-summary">2164</span> kN (點此展開計算)</summary><div id="tendon-force-calculation-details" class="p-2 bg-slate-200 rounded-md mt-1 font-mono text-xs"></div></details></div>
                        <div><label for="friction-mu" class="block text-sm font-medium text-slate-600">摩擦曲率效應係數 (μ)</label><input id="friction-mu" type="number" value="0.25" step="0.01" class="w-full p-2 border border-slate-300 rounded-md mt-1"><p class="text-xs text-slate-400 mt-1">建議值: 0.15 ~ 0.25 (鍍鋅套管)</p></div>
                        <div><label for="friction-k" class="block text-sm font-medium text-slate-600">波浪摩擦係數 (k, /m)</label><input id="friction-k" type="number" value="0.0049" step="0.0001" class="w-full p-2 border border-slate-300 rounded-md mt-1"><p class="text-xs text-slate-400 mt-1">建議值: 0.0049 (鍍鋅金屬套管)</p></div>
                        <div><label for="anchorage-slip" class="block text-sm font-medium text-slate-600">錨具滑動量 (&Delta;a) (mm)</label><input id="anchorage-slip" type="number" value="6" step="1" class="w-full p-2 border border-slate-300 rounded-md mt-1"><p class="text-xs text-slate-400 mt-1">建議值: 台灣(6mm), 日本(5-7mm), 美國(7mm)</p></div>
                    </div>
                    <h2 class="text-lg font-semibold text-slate-700 border-b pb-2 mt-6 mb-3">材料與長期損失參數</h2>
                    <div class="space-y-3">
                        <div><label for="mat-gamma-c" class="block text-sm font-medium text-slate-600">混凝土單位重 (γc, kN/m³)</label><input id="mat-gamma-c" type="number" value="24" step="0.5" class="w-full p-2 border border-slate-300 rounded-md mt-1"></div>
                        <div><label for="creep-phi" class="block text-sm font-medium text-slate-600">潛變係數 (φ)</label><input id="creep-phi" type="number" value="2.0" step="0.1" class="w-full p-2 border border-slate-300 rounded-md mt-1"><p class="text-xs text-slate-400 mt-1">建議值: 台灣/美國(AASHTO) 約 2.0, 日本(JSCE) 依條件計算，約 1.5 ~ 2.5。</p></div>
                        <div><label for="shrinkage-eps" class="block text-sm font-medium text-slate-600">乾縮應變 (εsh, x10⁻⁶)</label><input id="shrinkage-eps" type="number" value="200" step="10" class="w-full p-2 border border-slate-300 rounded-md mt-1"><p class="text-xs text-slate-400 mt-1">建議值: 台灣/美國(AASHTO) 約 200~400 x10⁻⁶, 日本(JSCE) 約 200 x10⁻⁶</p></div>
                        <div><label for="relaxation-rate" class="block text-sm font-medium text-slate-600">鋼材鬆弛率 (%)</label><input id="relaxation-rate" type="number" value="2.5" step="0.1" class="w-full p-2 border border-slate-300 rounded-md mt-1"><p class="text-xs text-slate-400 mt-1">建議值: 台灣/美國(AASHTO) 約 2.5% (低鬆弛鋼材), 日本(JSCE) 依鋼材種類而異。</p></div>
                    </div>
                </div>
                <div class="w-full md:w-8/12 p-6 md:p-8 overflow-y-auto"><h1 class="text-2xl font-bold text-slate-800 mb-4">預力損失計算結果</h1><div class="space-y-6"><div><h2 class="text-lg font-semibold text-slate-700 mb-2">瞬時損失 (Immediate Losses)</h2><table class="w-full text-sm"><thead class="text-left text-slate-500 bg-slate-100"><tr><th class="p-2 text-center">鋼腱 ID</th><th class="p-2 text-right">摩擦損失 (kN)</th><th class="p-2 text-right">端錨損失 (kN)</th><th class="p-2 text-right">彈性縮短 (kN)</th><th class="p-2 text-right">小計 (kN)</th><th class="p-2 text-right">%</th></tr></thead><tbody id="immediate-loss-table-body"></tbody></table></div><div><h2 class="text-lg font-semibold text-slate-700 mb-2">長期損失 (Long-term Losses)</h2><table class="w-full text-sm"><thead class="text-left text-slate-500 bg-slate-100"><tr><th class="p-2">損失項目</th><th class="p-2 text-right">損失值 (kN)</th><th class="p-2 text-right">%</th></tr></thead><tbody id="longterm-loss-table-body"></tbody></table></div><div><h2 class="text-lg font-semibold text-slate-700 mb-2">總損失 (Total Losses)</h2><table class="w-full text-sm"><thead class="text-left text-slate-500 bg-slate-100"><tr><th class="p-2">損失項目</th><th class="p-2 text-right">損失值 (kN)</th><th class="p-2 text-right">%</th></tr></thead><tbody id="total-loss-table-body"></tbody></table></div><div><h2 class="text-lg font-semibold text-slate-700 mb-2">鋼腱最大應力檢核 (施拉後)</h2><table class="w-full text-sm"><thead class="text-left text-slate-500 bg-slate-100"><tr><th class="p-2 text-center">ID</th><th class="p-2 text-right">錨定後應力(MPa)</th><th class="p-2 text-right">最大應力(MPa)</th><th class="p-2 text-right">容許應力(MPa)</th><th class="p-2 text-right">應力比</th><th class="p-2 text-center">結果</th></tr></thead><tbody id="stress-check-results-table-body"></tbody></table></div></div></div>
            </div>
            <div id="stress-check-view" class="hidden w-full h-full flex flex-col md:flex-row">
                 <div class="w-full md:w-4/12 p-6 md:p-8 bg-slate-50 border-r border-slate-200 overflow-y-auto"><h1 class="text-2xl font-bold text-slate-800 mb-6">應力檢核參數</h1><div class="space-y-4"><div><label for="mat-fci" class="block text-sm font-medium text-slate-700 mb-1">施加預力時混凝土強度 ($f'_{ci}$, MPa)</label><input type="number" id="mat-fci" value="28" step="1" class="w-full p-2 border border-slate-300 rounded-md"></div><div><label for="mat-fc" class="block text-sm font-medium text-slate-700 mb-1">混凝土28天設計強度 ($f'_{c}$, MPa)</label><input type="number" id="mat-fc" value="35" step="1" class="w-full p-2 border border-slate-300 rounded-md"></div><h2 class="text-lg font-semibold text-slate-700 border-b pb-2 !mt-6 mb-3">外加載重彎矩</h2><div><label for="moment-sd" class="block text-sm font-medium text-slate-700 mb-1">靜載重彎矩 ($M_{sd}$)</label><input type="number" id="moment-sd" value="500" step="10" class="w-full p-2 border border-slate-300 rounded-md"><p class="text-xs text-slate-400 mt-1">建議值: <span id="recommended-msd">500</span> kN-m</p></div><div><label for="moment-ll" class="block text-sm font-medium text-slate-700 mb-1">活載重彎矩 ($M_{ll}$)</label><input type="number" id="moment-ll" value="1500" step="10" class="w-full p-2 border border-slate-300 rounded-md"><p class="text-xs text-slate-400 mt-1">建議值: <span id="recommended-mll">1500</span> kN-m</p></div></div></div>
                <div id="stress-check-results-container" class="w-full md:w-8/12 p-6 md:p-8 overflow-y-auto"></div>
            </div>
            <div id="flexure-check-view" class="hidden w-full h-full flex flex-col p-6 md:p-8 overflow-y-auto">
                <div id="flexure-check-results-container"></div>
            </div>
            <div id="deflection-check-view" class="hidden w-full h-full flex flex-col p-6 md:p-8 overflow-y-auto">
                <div id="deflection-check-results-container"></div>
            </div>
            <div id="shear-check-view" class="hidden w-full h-full flex flex-col md:flex-row">
                 <div class="w-full md:w-5/12 p-6 md:p-8 bg-slate-50 border-r border-slate-200 overflow-y-auto"><h1 class="text-2xl font-bold text-slate-800 mb-6">剪力筋檢核參數</h1><table class="w-full text-sm"><tbody class="divide-y divide-slate-200"><tr class="divide-x divide-slate-200"><td class="py-3 pr-4">斷面設計剪力 ($V_u$)</td><td class="py-2 pl-4"><input type="number" id="shear-vu" value="1200" step="10" class="w-full p-2 border border-slate-300 rounded-md"><p class="text-xs text-slate-400 mt-1">支承面 d 距離處之設計剪力</p></td></tr><tr class="divide-x divide-slate-200"><td class="py-3 pr-4">剪力鋼筋降伏強度 ($f_{yt}$)</td><td class="py-2 pl-4"><input type="number" id="shear-fyt" value="280" step="10" class="w-full p-2 border border-slate-300 rounded-md"></td></tr><tr class="divide-x divide-slate-200"><td class="py-3 pr-4">剪力筋號數</td><td class="py-2 pl-4"><select id="shear-bar-size" class="w-full p-2 border border-slate-300 rounded-md"><option>D10</option><option selected>D13</option><option>D16</option><option>D19</option></select></td></tr><tr class="divide-x divide-slate-200"><td class="py-3 pr-4">剪力筋股數</td><td class="py-2 pl-4"><input type="number" id="shear-legs" value="4" step="1" class="w-full p-2 border border-slate-300 rounded-md"></td></tr><tr class="divide-x divide-slate-200"><td class="py-3 pr-4">剪力筋間距 (s)</td><td class="py-2 pl-4"><input type="number" id="shear-spacing" value="150" step="10" class="w-full p-2 border border-slate-300 rounded-md"></td></tr></tbody></table></div>
                <div id="shear-check-results-container" class="w-full md:w-7/12 p-6 md:p-8 overflow-y-auto"></div>
            </div>
        </div>
    </div>
    <script src="js/main.js" type="module"></script>
</body>
</html>
